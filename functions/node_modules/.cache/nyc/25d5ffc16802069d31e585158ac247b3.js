var cov_1w6bassul1=function(){var path="/home/kaztoozs/Documents/Projects/CallDeskTest/functions/index.js",hash="e10dcea58cff5268c1f0314b8b20b3e7609e7efa",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/kaztoozs/Documents/Projects/CallDeskTest/functions/index.js",statementMap:{"0":{start:{line:3,column:18},end:{line:3,column:47}},"1":{start:{line:4,column:16},end:{line:4,column:39}},"2":{start:{line:7,column:0},end:{line:24,column:3}},"3":{start:{line:9,column:18},end:{line:9,column:61}},"4":{start:{line:12,column:20},end:{line:12,column:22}},"5":{start:{line:13,column:2},end:{line:16,column:3}},"6":{start:{line:14,column:4},end:{line:14,column:55}},"7":{start:{line:19,column:2},end:{line:23,column:5}},"8":{start:{line:20,column:4},end:{line:20,column:42}},"9":{start:{line:22,column:4},end:{line:22,column:86}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:66},end:{line:7,column:67}},loc:{start:{line:7,column:80},end:{line:24,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:52},end:{line:19,column:53}},loc:{start:{line:19,column:64},end:{line:21,column:3}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:11},end:{line:21,column:12}},loc:{start:{line:21,column:17},end:{line:23,column:3}},line:21}},branchMap:{"0":{loc:{start:{line:13,column:2},end:{line:16,column:3}},type:"if",locations:[{start:{line:13,column:2},end:{line:16,column:3}},{start:{line:13,column:2},end:{line:16,column:3}}],line:13}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();// @flow
const functions=(cov_1w6bassul1.s[0]++,require('firebase-functions'));const weather=(cov_1w6bassul1.s[1]++,require('./weather.js'));cov_1w6bassul1.s[2]++;exports.dialogflowFirebaseFulfillment=functions.https.onRequest((req,res)=>{cov_1w6bassul1.f[0]++;// Get the city and date from the request
const geocity=(cov_1w6bassul1.s[3]++,req.body.queryResult.parameters['geo-city']);// city is a required param
// Get the date for the weather forecast (if present)
let desiredDate=(cov_1w6bassul1.s[4]++,'');cov_1w6bassul1.s[5]++;if(req.body.queryResult.parameters.date){cov_1w6bassul1.b[0][0]++;cov_1w6bassul1.s[6]++;desiredDate=req.body.queryResult.parameters.date;// console.log(`Date: ${date}`);
}else{cov_1w6bassul1.b[0][1]++;}// Call the weather API
cov_1w6bassul1.s[7]++;weather.callWeatherApi(geocity,desiredDate).then(output=>{cov_1w6bassul1.f[1]++;cov_1w6bassul1.s[8]++;res.json({fulfillmentText:output});// Return the results of the weather API to Dialogflow
}).catch(()=>{cov_1w6bassul1.f[2]++;cov_1w6bassul1.s[9]++;res.json({fulfillmentText:'I don\'t know the weather but I hope it\'s good!'});});});